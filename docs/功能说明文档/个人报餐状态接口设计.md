# ä¸ªäººæŠ¥é¤çŠ¶æ€æ¥å£è®¾è®¡

## ğŸ¯ æ¥å£ç›®æ ‡
ä¸ºå‰ç«¯æä¾›ä¸ªäººå½“å¤©çš„æŠ¥é¤çŠ¶æ€ä¿¡æ¯ï¼Œç”¨äºç”Ÿæˆç”¨é¤å¡ç‰‡ï¼ŒåŒ…å«æ—©ä¸­æ™šä¸‰ä¸ªé¤æ¬¡çš„æŠ¥é¤æƒ…å†µã€‚

## ğŸ“Š æ•°æ®ç»“æ„è®¾è®¡

### æ¥å£è·¯å¾„
```
GET /api/dining/personal-status?date=2025-09-04
```

### è¯·æ±‚å‚æ•°
- `date` (å¯é€‰): æŸ¥è¯¢æ—¥æœŸï¼Œé»˜è®¤ä¸ºä»Šå¤©
- éœ€è¦ç”¨æˆ·è®¤è¯Token

### å“åº”æ•°æ®ç»“æ„
```json
{
  "success": true,
  "message": "è·å–ä¸ªäººæŠ¥é¤çŠ¶æ€æˆåŠŸ",
  "data": {
    "userId": "user_123",
    "userName": "å¼ ä¸‰",
    "department": "æŠ€æœ¯éƒ¨",
    "queryDate": "2025-09-04",
    "mealStatus": {
      "breakfast": {
        "isRegistered": true,
        "status": "confirmed",
        "statusText": "å·²ç¡®è®¤",
        "orderId": "order_123",
        "menuId": "menu_123",
        "menuName": "ä»Šæ—¥æ—©é¤",
        "dishes": [
          {
            "dishId": "dish_1",
            "dishName": "å°ç¬¼åŒ…",
            "price": 8.00,
            "image": "https://example.com/image1.jpg"
          }
        ],
        "totalAmount": 8.00,
        "registerTime": "2025-09-04T08:30:00.000Z",
        "registrantName": "éƒ¨é—¨ç®¡ç†å‘˜",
        "remark": "å¤‡æ³¨ä¿¡æ¯"
      },
      "lunch": {
        "isRegistered": true,
        "status": "pending",
        "statusText": "å¾…ç¡®è®¤",
        "orderId": "order_124",
        "menuId": "menu_124",
        "menuName": "ä»Šæ—¥åˆé¤",
        "dishes": [
          {
            "dishId": "dish_2",
            "dishName": "å®«ä¿é¸¡ä¸",
            "price": 15.00,
            "image": "https://example.com/image2.jpg"
          }
        ],
        "totalAmount": 15.00,
        "registerTime": "2025-09-04T10:15:00.000Z",
        "registrantName": "éƒ¨é—¨ç®¡ç†å‘˜",
        "remark": ""
      },
      "dinner": {
        "isRegistered": false,
        "status": null,
        "statusText": "æœªæŠ¥é¤",
        "orderId": null,
        "menuId": null,
        "menuName": null,
        "dishes": [],
        "totalAmount": 0.00,
        "registerTime": null,
        "registrantName": null,
        "remark": null
      }
    },
    "summary": {
      "totalRegistered": 2,
      "totalAmount": 23.00,
      "confirmedCount": 1,
      "pendingCount": 1,
      "unregisteredCount": 1
    },
    "availableMenus": {
      "breakfast": {
        "menuId": "menu_123",
        "menuName": "ä»Šæ—¥æ—©é¤",
        "publishStatus": "published",
        "dishes": [...]
      },
      "lunch": {
        "menuId": "menu_124", 
        "menuName": "ä»Šæ—¥åˆé¤",
        "publishStatus": "published",
        "dishes": [...]
      },
      "dinner": {
        "menuId": null,
        "menuName": null,
        "publishStatus": null,
        "dishes": []
      }
    }
  }
}
```

## ğŸ” ä¸šåŠ¡é€»è¾‘

### 1. æŠ¥é¤çŠ¶æ€åˆ¤æ–­
- æŸ¥è¯¢ `dining_orders` è¡¨ä¸­ `memberIds` JSONå­—æ®µæ˜¯å¦åŒ…å«å½“å‰ç”¨æˆ·ID
- æ ¹æ® `status` å­—æ®µåˆ¤æ–­æŠ¥é¤çŠ¶æ€ï¼š
  - `pending`: å¾…ç¡®è®¤
  - `confirmed`: å·²ç¡®è®¤  
  - `completed`: å·²å®Œæˆ
  - `cancelled`: å·²å–æ¶ˆ

### 2. èœå•ä¿¡æ¯è·å–
- é€šè¿‡ `menuId` å…³è” `menus` è¡¨è·å–èœå•è¯¦æƒ…
- é€šè¿‡ `menu_dishes` è¡¨è·å–èœå“åˆ—è¡¨

### 3. éªŒè¯è®°å½•æŸ¥è¯¢
- æŸ¥è¯¢ `dining_verifications` è¡¨è·å–ç”¨é¤éªŒè¯è®°å½•
- ç”¨äºåˆ¤æ–­æ˜¯å¦å·²ç»ç”¨é¤

## ğŸ¨ å‰ç«¯ä½¿ç”¨åœºæ™¯

### ç”¨é¤å¡ç‰‡å±•ç¤º
```javascript
// æ—©é¤å¡ç‰‡
if (data.mealStatus.breakfast.isRegistered) {
  if (data.mealStatus.breakfast.status === 'confirmed') {
    // æ˜¾ç¤ºå·²ç¡®è®¤çš„æ—©é¤å¡ç‰‡
    // åŒ…å«èœå“ä¿¡æ¯ã€ä»·æ ¼ã€çŠ¶æ€ç­‰
  } else if (data.mealStatus.breakfast.status === 'pending') {
    // æ˜¾ç¤ºå¾…ç¡®è®¤çš„æ—©é¤å¡ç‰‡
  }
} else {
  // æ˜¾ç¤ºæœªæŠ¥é¤çŠ¶æ€
  // å¯èƒ½æ˜¾ç¤ºå¯ç”¨çš„æ—©é¤èœå•ä¾›é€‰æ‹©
}
```

### çŠ¶æ€æŒ‡ç¤ºå™¨
- âœ… å·²ç¡®è®¤æŠ¥é¤
- â³ å¾…ç¡®è®¤æŠ¥é¤  
- âŒ æœªæŠ¥é¤
- ğŸ½ï¸ å·²ç”¨é¤ï¼ˆé€šè¿‡éªŒè¯è®°å½•åˆ¤æ–­ï¼‰

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

1. **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨å•æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰é¤æ¬¡ä¿¡æ¯
2. **æ•°æ®å®Œæ•´æ€§**: å¤„ç†èœå•ä¸å­˜åœ¨ã€èœå“ä¿¡æ¯ç¼ºå¤±ç­‰æƒ…å†µ
3. **æƒé™æ§åˆ¶**: ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æŠ¥é¤çŠ¶æ€
4. **ç¼“å­˜ç­–ç•¥**: å¯è€ƒè™‘ç¼“å­˜èœå•ä¿¡æ¯å‡å°‘æ•°æ®åº“æŸ¥è¯¢
5. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé»˜è®¤å€¼è®¾ç½®

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

- å“åº”å¼è®¾è®¡é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- å¡ç‰‡å¼å¸ƒå±€ä¾¿äºæ»‘åŠ¨æµè§ˆ
- çŠ¶æ€é¢œè‰²åŒºåˆ†ä¾¿äºå¿«é€Ÿè¯†åˆ«
- æ”¯æŒå¿«é€Ÿæ“ä½œï¼ˆå¦‚å–æ¶ˆæŠ¥é¤ã€é‡æ–°æŠ¥é¤ç­‰ï¼‰
