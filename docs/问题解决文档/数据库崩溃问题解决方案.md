# æ•°æ®åº“å´©æºƒé—®é¢˜è§£å†³æ–¹æ¡ˆ

## é—®é¢˜æè¿°

åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å´©æºƒï¼Œé”™è¯¯ä¿¡æ¯ï¼š
```
{
    "success": false,
    "message": "éƒ¨é—¨ç®¡ç†å‘˜æµ‹è¯•ç™»å½•å¤±è´¥",
    "error": "Table 'smart_property.users' doesn't exist"
}
```

## é—®é¢˜æ ¹å› 

æ•°æ®åº“ä¸­ç¼ºå°‘åŸºç¡€çš„ `users` è¡¨ï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºåœ¨å°è¯•æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯æ—¶å¤±è´¥ã€‚

## è§£å†³æ­¥éª¤

### 1. è¯Šæ–­é—®é¢˜
- âœ… ç¡®è®¤åº”ç”¨ç¨‹åºå´©æºƒåŸå› ï¼šç¼ºå°‘ `users` è¡¨
- âœ… æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®ï¼šæ­£å¸¸
- âœ… ç¡®è®¤é”™è¯¯æ—¥å¿—ä¿¡æ¯ï¼šTable 'smart_property.users' doesn't exist

### 2. æ•°æ®åº“åˆå§‹åŒ–
è¿è¡Œå®Œæ•´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š
```bash
node scripts/initDatabase-complete.js init
```

**åˆ›å»ºçš„è¡¨åŒ…æ‹¬ï¼š**
- âœ… system_configs (ç³»ç»Ÿé…ç½®è¡¨)
- âœ… verification_codes (éªŒè¯ç è¡¨)
- âœ… dining_tables (é¤æ¡Œè¡¨)
- âœ… departments (éƒ¨é—¨è¡¨)
- âœ… users (ç”¨æˆ·è¡¨) â­ **å…³é”®è¡¨**
- âœ… user_tokens (ç”¨æˆ·ä»¤ç‰Œè¡¨)
- âœ… menus (èœå•è¡¨)
- âœ… dining_orders (æŠ¥é¤è®°å½•è¡¨)
- âœ… special_reservations (ç‰¹æ®Šé¢„çº¦è¡¨)
- âœ… venues (åœºåœ°è¡¨)
- âœ… reservations (åœºåœ°é¢„çº¦è¡¨)
- âœ… dining_verifications (ç”¨é¤éªŒè¯è®°å½•è¡¨)
- âœ… system_announcements (ç³»ç»Ÿå…¬å‘Šè¡¨)
- âœ… activity_logs (æ´»åŠ¨æ—¥å¿—è¡¨)
- âœ… file_uploads (æ–‡ä»¶ä¸Šä¼ è¡¨)

**æ’å…¥çš„ç¤ºä¾‹æ•°æ®ï¼š**
- âœ… éƒ¨é—¨: 3 æ¡ (æŠ€æœ¯éƒ¨ã€äººäº‹éƒ¨ã€è´¢åŠ¡éƒ¨)
- âœ… åœºåœ°: 3 æ¡ (ç¾½æ¯›çƒåœºAã€ä¹’ä¹“çƒå°1å·ã€ç¯®çƒåœº)
- âœ… é¤æ¡Œ: 3 æ¡ (AåŒº01å·æ¡Œã€AåŒº02å·æ¡Œã€BåŒº01å·æ¡Œ)
- âœ… é…ç½®: 4 æ¡ (ç³»ç»Ÿé…ç½®é¡¹)

### 3. åˆ›å»ºæµ‹è¯•ç®¡ç†å‘˜ç”¨æˆ·
è¿è¡Œç”¨æˆ·åˆ›å»ºè„šæœ¬ï¼š
```bash
node scripts/create-test-admin.js
```

**åˆ›å»ºçš„æµ‹è¯•ç”¨æˆ·ï¼š**
- âœ… éƒ¨é—¨ç®¡ç†å‘˜æµ‹è¯• (æ‰‹æœºå·: 13800000001, è§’è‰²: dept_admin)
- âœ… ç³»ç»Ÿç®¡ç†å‘˜æµ‹è¯• (æ‰‹æœºå·: 13800000002, è§’è‰²: sys_admin)

### 4. å¯åŠ¨æœåŠ¡å™¨
```bash
npm run dev
```

æœåŠ¡å™¨çŠ¶æ€ï¼šâœ… æ­£å¸¸è¿è¡Œåœ¨ç«¯å£ 3000

### 5. éªŒè¯ä¿®å¤ç»“æœ

**å¥åº·æ£€æŸ¥ï¼š**
```bash
curl http://localhost:3000/health
```
å“åº”ï¼š
```json
{
  "success": true,
  "message": "æœåŠ¡è¿è¡Œæ­£å¸¸",
  "timestamp": "2025-08-27T10:02:20.589Z",
  "database": "å·²è¿æ¥"
}
```

**éƒ¨é—¨ç®¡ç†å‘˜ç™»å½•æµ‹è¯•ï¼š**
```bash
curl -X POST http://localhost:3000/api/auth/test-login \
  -H "Content-Type: application/json" \
  -d '{"phoneNumber": "13800000001", "role": "dept_admin"}'
```
å“åº”ï¼šâœ… ç™»å½•æˆåŠŸï¼Œè¿”å›æœ‰æ•ˆToken

**ç³»ç»Ÿç®¡ç†å‘˜ç™»å½•æµ‹è¯•ï¼š**
```bash
curl -X POST http://localhost:3000/api/auth/test-login \
  -H "Content-Type: application/json" \
  -d '{"phoneNumber": "13800000002", "role": "sys_admin"}'
```
å“åº”ï¼šâœ… ç™»å½•æˆåŠŸï¼Œè¿”å›æœ‰æ•ˆToken

## ä¿®å¤ç»“æœ

ğŸ‰ **é—®é¢˜å·²å®Œå…¨è§£å†³ï¼**

- âœ… æ•°æ®åº“è¡¨ç»“æ„å®Œæ•´
- âœ… ç¤ºä¾‹æ•°æ®å·²æ’å…¥
- âœ… æµ‹è¯•ç®¡ç†å‘˜ç”¨æˆ·å·²åˆ›å»º
- âœ… æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ
- âœ… éƒ¨é—¨ç®¡ç†å‘˜ç™»å½•åŠŸèƒ½æ­£å¸¸
- âœ… ç³»ç»Ÿç®¡ç†å‘˜ç™»å½•åŠŸèƒ½æ­£å¸¸

## æµ‹è¯•å‡­æ®

### éƒ¨é—¨ç®¡ç†å‘˜
- æ‰‹æœºå·ï¼š`13800000001`
- è§’è‰²ï¼š`dept_admin`
- æµ‹è¯•ç™»å½•APIï¼š`POST /api/auth/test-login`

### ç³»ç»Ÿç®¡ç†å‘˜  
- æ‰‹æœºå·ï¼š`13800000002`
- è§’è‰²ï¼š`sys_admin`
- æµ‹è¯•ç™»å½•APIï¼š`POST /api/auth/test-login`

## é¢„é˜²æªæ–½

1. **å®šæœŸæ•°æ®åº“å¤‡ä»½**ï¼šç¡®ä¿æ•°æ®åº“ç»“æ„å’Œæ•°æ®çš„å®Œæ•´æ€§
2. **ç¯å¢ƒä¸€è‡´æ€§æ£€æŸ¥**ï¼šéƒ¨ç½²å‰éªŒè¯æ•°æ®åº“è¡¨ç»“æ„æ˜¯å¦å®Œæ•´
3. **å¥åº·æ£€æŸ¥ç›‘æ§**ï¼šå®æ–½åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“çš„å¥åº·çŠ¶æ€ç›‘æ§
4. **åˆå§‹åŒ–è„šæœ¬ç»´æŠ¤**ï¼šä¿æŒæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬çš„æ›´æ–°å’Œæµ‹è¯•

## ç›¸å…³æ–‡ä»¶

- `/scripts/initDatabase-complete.js` - å®Œæ•´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- `/scripts/create-test-admin.js` - æµ‹è¯•ç®¡ç†å‘˜ç”¨æˆ·åˆ›å»ºè„šæœ¬
- `/config/database.js` - æ•°æ®åº“é…ç½®æ–‡ä»¶
- `/server.js` - ä¸»æœåŠ¡å™¨æ–‡ä»¶

---

**è§£å†³æ—¶é—´ï¼š** 2025-08-27 10:03:00  
**è§£å†³çŠ¶æ€ï¼š** âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€ï¼š** âœ… é€šè¿‡
