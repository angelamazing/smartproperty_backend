# 智慧物业管理系统 - 数据库设计文档

## 概述

基于完整的接口分析，重新设计智慧物业管理系统的数据库结构，确保覆盖所有业务需求。

## 业务模块分析

### 1. 用户认证模块 (/api/auth)
- 微信授权登录
- 手机号验证码登录  
- Token管理
- 测试登录（开发环境）

### 2. 用户管理模块 (/api/user)
- 用户信息管理
- 用户统计数据
- 角色权限管理
- 批量操作

### 3. 日常报餐模块 (/api/dining)
- 菜单管理
- 部门报餐
- 报餐记录
- 统计分析

### 4. 特殊预约模块 (/api/reservation)
- 特殊预约申请
- 审核流程
- 预约记录

### 5. 场地预约模块 (/api/venue)
- 场地管理
- 预约管理
- 场地安排表

### 6. 用餐验证模块 (/api/verification)
- 用餐验证
- 餐桌管理
- 验证记录

### 7. 系统管理模块 (/api/system)
- 统计数据
- 系统公告
- 活动记录

## 数据库表设计

### 核心表

#### 1. users (用户表)
存储所有用户信息，支持微信用户和手机号用户

#### 2. user_tokens (用户令牌表)
管理用户登录凭证，支持Token过期和刷新

#### 3. verification_codes (验证码表) 
存储短信验证码，防止重复发送和暴力破解

### 业务表

#### 4. menus (菜单表)
存储每日菜单信息，包含菜品详情和营养信息

#### 5. dining_orders (报餐记录表)
记录日常报餐信息，支持部门批量报餐

#### 6. special_reservations (特殊预约表)
存储特殊预约申请，支持审核流程

#### 7. venues (场地表)
存储场地基本信息，支持多种场地类型

#### 8. reservations (场地预约表)
记录场地预约信息，防止时间冲突

#### 9. dining_tables (餐桌表)
存储餐桌信息和状态，支持验证码验证

#### 10. dining_verifications (用餐验证记录表)
记录用餐验证信息，统计用餐数据

### 扩展表

#### 11. departments (部门表)
标准化部门信息管理

#### 12. system_announcements (系统公告表)
系统公告和通知信息

#### 13. activity_logs (活动日志表)
记录系统重要操作日志

#### 14. file_uploads (文件上传表)
管理头像和其他文件上传

#### 15. system_configs (系统配置表)
存储系统配置参数

## 关键设计原则

1. **数据一致性**: 使用外键约束确保数据关联的完整性
2. **性能优化**: 为查询频繁的字段添加索引
3. **扩展性**: 预留扩展字段，支持业务发展
4. **安全性**: 敏感数据加密存储，权限严格控制
5. **审计性**: 重要操作记录操作日志

