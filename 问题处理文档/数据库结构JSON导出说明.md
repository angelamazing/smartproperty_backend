# æ•°æ®åº“ç»“æ„JSONå¯¼å‡ºè¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•å°†æ™ºæ…§ç‰©ä¸šç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“ç»“æ„å¯¼å‡ºä¸ºJSONæ ¼å¼ï¼Œä»¥åŠå¯¼å‡ºçš„JSONæ–‡ä»¶çš„ç»“æ„å’Œä½¿ç”¨æ–¹æ³•ã€‚

## ğŸš€ å¿«é€Ÿå¯¼å‡º

### å¯¼å‡ºå®Œæ•´æ•°æ®åº“ç»“æ„
```bash
node scripts/exportDatabaseSchema.js export
```

### å¯¼å‡ºæ•°æ®åº“æ‘˜è¦
```bash
node scripts/exportDatabaseSchema.js summary
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶

### 1. database-schema.json - å®Œæ•´æ•°æ®åº“ç»“æ„
åŒ…å«æ‰€æœ‰è¡¨çš„è¯¦ç»†ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
- å­—æ®µå®šä¹‰å’Œç±»å‹
- ç´¢å¼•ä¿¡æ¯
- å¤–é”®å…³ç³»
- è¡¨å±æ€§ï¼ˆå¼•æ“ã€å­—ç¬¦é›†ç­‰ï¼‰

### 2. database-summary.json - æ•°æ®åº“æ‘˜è¦
åŒ…å«ç®€åŒ–çš„è¡¨ç»“æ„ä¿¡æ¯ï¼Œä¾¿äºå¿«é€ŸæŸ¥çœ‹ï¼š
- è¡¨åŸºæœ¬ä¿¡æ¯
- ä¸»é”®åˆ—è¡¨
- ç´¢å¼•æ‘˜è¦
- å¤–é”®å…³ç³»

## ğŸ“Š å¯¼å‡ºç»Ÿè®¡

æ ¹æ®æœ€æ–°å¯¼å‡ºç»“æœï¼š
- **è¡¨æ•°é‡**: 26ä¸ª
- **å­—æ®µæ•°é‡**: 336ä¸ª
- **ç´¢å¼•æ•°é‡**: 189ä¸ª
- **å¤–é”®æ•°é‡**: 31ä¸ª

## ğŸ” JSONæ–‡ä»¶ç»“æ„

### å®Œæ•´ç»“æ„æ–‡ä»¶ (database-schema.json)

```json
{
  "database": {
    "name": "smart_property",
    "charset": "utf8mb4",
    "collation": "utf8mb4_unicode_ci",
    "exportTime": "2025-09-14T01:50:22.088Z",
    "exportVersion": "1.0.0"
  },
  "tables": {
    "table_name": {
      "name": "table_name",
      "comment": "è¡¨æ³¨é‡Š",
      "engine": "InnoDB",
      "collation": "utf8mb4_unicode_ci",
      "rows": 0,
      "dataLength": 16384,
      "indexLength": 114688,
      "fields": {
        "field_name": {
          "name": "field_name",
          "type": {
            "type": "string",
            "baseType": "varchar",
            "length": 36,
            "original": "varchar(36)"
          },
          "attributes": {
            "nullable": false,
            "key": "PRI",
            "isPrimaryKey": true,
            "comment": "å­—æ®µæ³¨é‡Š"
          }
        }
      },
      "indexes": [
        {
          "name": "PRIMARY",
          "unique": true,
          "columns": ["_id"]
        }
      ],
      "foreignKeys": [
        {
          "name": "fk_name",
          "column": "user_id",
          "referencedTable": "users",
          "referencedColumn": "_id",
          "updateRule": "CASCADE",
          "deleteRule": "SET NULL"
        }
      ]
    }
  },
  "statistics": {
    "totalTables": 26,
    "totalFields": 336,
    "totalIndexes": 189,
    "totalForeignKeys": 31
  }
}
```

### æ‘˜è¦æ–‡ä»¶ (database-summary.json)

```json
{
  "database": {
    "name": "smart_property",
    "charset": "utf8mb4",
    "collation": "utf8mb4_unicode_ci",
    "exportTime": "2025-09-14T01:50:22.088Z",
    "exportVersion": "1.0.0"
  },
  "tables": {
    "table_name": {
      "comment": "è¡¨æ³¨é‡Š",
      "engine": "InnoDB",
      "fieldCount": 14,
      "primaryKeys": ["_id"],
      "indexes": [
        {
          "name": "idx_name",
          "unique": false,
          "columns": ["field1", "field2"]
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users._id"
        }
      ]
    }
  },
  "relationships": [
    {
      "from": "table1.field1",
      "to": "table2.field2",
      "updateRule": "CASCADE",
      "deleteRule": "SET NULL"
    }
  ]
}
```

## ğŸ› ï¸ å­—æ®µç±»å‹æ˜ å°„

| MySQLç±»å‹ | JSONç±»å‹ | è¯´æ˜ |
|-----------|----------|------|
| varchar(n) | string | å˜é•¿å­—ç¬¦ä¸² |
| char(n) | string | å®šé•¿å­—ç¬¦ä¸² |
| text | string | é•¿æ–‡æœ¬ |
| int | number | æ•´æ•° |
| bigint | number | é•¿æ•´æ•° |
| decimal(p,s) | number | ç²¾ç¡®å°æ•° |
| float | number | æµ®ç‚¹æ•° |
| double | number | åŒç²¾åº¦æµ®ç‚¹æ•° |
| boolean | boolean | å¸ƒå°”å€¼ |
| date | date | æ—¥æœŸ |
| datetime | datetime | æ—¥æœŸæ—¶é—´ |
| timestamp | timestamp | æ—¶é—´æˆ³ |
| json | object | JSONå¯¹è±¡ |
| enum | enum | æšä¸¾å€¼ |

## ğŸ“‹ å­—æ®µå±æ€§è¯´æ˜

### åŸºæœ¬å±æ€§
- `nullable`: æ˜¯å¦å…è®¸NULLå€¼
- `key`: é”®ç±»å‹ (PRI=ä¸»é”®, UNI=å”¯ä¸€é”®, MUL=æ™®é€šç´¢å¼•)
- `default`: é»˜è®¤å€¼
- `extra`: é¢å¤–å±æ€§ (auto_incrementç­‰)
- `comment`: å­—æ®µæ³¨é‡Š

### ç±»å‹å±æ€§
- `type`: æ˜ å°„åçš„ç±»å‹
- `baseType`: MySQLåŸå§‹ç±»å‹
- `length`: é•¿åº¦é™åˆ¶
- `precision`: ç²¾åº¦ (decimalç±»å‹)
- `scale`: å°æ•°ä½æ•° (decimalç±»å‹)
- `unsigned`: æ˜¯å¦æ— ç¬¦å·
- `original`: åŸå§‹ç±»å‹å®šä¹‰

## ğŸ”— å¤–é”®å…³ç³»è¯´æ˜

### å¤–é”®å±æ€§
- `name`: å¤–é”®çº¦æŸåç§°
- `column`: å½“å‰è¡¨å­—æ®µ
- `referencedTable`: å¼•ç”¨è¡¨å
- `referencedColumn`: å¼•ç”¨å­—æ®µå
- `updateRule`: æ›´æ–°è§„åˆ™ (CASCADE, SET NULL, RESTRICT, NO ACTION)
- `deleteRule`: åˆ é™¤è§„åˆ™ (CASCADE, SET NULL, RESTRICT, NO ACTION)

## ğŸ“Š ç´¢å¼•ä¿¡æ¯è¯´æ˜

### ç´¢å¼•å±æ€§
- `name`: ç´¢å¼•åç§°
- `unique`: æ˜¯å¦å”¯ä¸€ç´¢å¼•
- `type`: ç´¢å¼•ç±»å‹ (BTREE, HASHç­‰)
- `columns`: ç´¢å¼•åŒ…å«çš„å­—æ®µåˆ—è¡¨

### å­—æ®µåœ¨ç´¢å¼•ä¸­çš„å±æ€§
- `column`: å­—æ®µå
- `seq`: åœ¨ç´¢å¼•ä¸­çš„ä½ç½®
- `subPart`: å­éƒ¨åˆ†é•¿åº¦
- `null`: æ˜¯å¦å…è®¸NULL
- `collation`: æ’åºè§„åˆ™

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆ
- è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
- ç”Ÿæˆæ•°æ®å­—å…¸
- åˆ›å»ºæ•°æ®åº“è®¾è®¡æ–‡æ¡£

### 2. ä»£ç ç”Ÿæˆ
- è‡ªåŠ¨ç”Ÿæˆæ¨¡å‹ç±»
- ç”ŸæˆDTOå¯¹è±¡
- åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬

### 3. æ•°æ®è¿ç§»
- è·¨æ•°æ®åº“è¿ç§»
- æ•°æ®ç»“æ„å¯¹æ¯”
- ç‰ˆæœ¬å‡çº§æ£€æŸ¥

### 4. å¼€å‘å·¥å…·é›†æˆ
- IDEæ’ä»¶å¼€å‘
- æ•°æ®åº“ç®¡ç†å·¥å…·
- ä»£ç ç”Ÿæˆå™¨

## ğŸ”§ è„šæœ¬åŠŸèƒ½

### ä¸»è¦åŠŸèƒ½
1. **è¿æ¥æ•°æ®åº“**: è‡ªåŠ¨è¿æ¥MySQLæ•°æ®åº“
2. **è·å–è¡¨åˆ—è¡¨**: æŸ¥è¯¢æ‰€æœ‰è¡¨å
3. **è§£æè¡¨ç»“æ„**: è¯¦ç»†è§£ææ¯ä¸ªè¡¨çš„ç»“æ„
4. **å¤„ç†å­—æ®µç±»å‹**: æ™ºèƒ½æ˜ å°„MySQLç±»å‹åˆ°JSONç±»å‹
5. **æå–ç´¢å¼•ä¿¡æ¯**: è·å–æ‰€æœ‰ç´¢å¼•å’Œé”®ä¿¡æ¯
6. **åˆ†æå¤–é”®å…³ç³»**: è§£æè¡¨é—´å…³ç³»
7. **ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯**: è®¡ç®—æ•°æ®åº“ç»Ÿè®¡æŒ‡æ ‡

### é”™è¯¯å¤„ç†
- æ•°æ®åº“è¿æ¥å¤±è´¥å¤„ç†
- è¡¨ç»“æ„è§£æé”™è¯¯å¤„ç†
- å¤–é”®æŸ¥è¯¢å…¼å®¹æ€§å¤„ç†
- æ–‡ä»¶å†™å…¥é”™è¯¯å¤„ç†

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æƒé™è¦æ±‚**: éœ€è¦æ•°æ®åº“çš„SELECTæƒé™
2. **å­—ç¬¦é›†**: ç¡®ä¿æ•°æ®åº“ä½¿ç”¨UTF-8å­—ç¬¦é›†
3. **ç‰ˆæœ¬å…¼å®¹**: æ”¯æŒMySQL 5.7+ç‰ˆæœ¬
4. **æ–‡ä»¶å¤§å°**: å®Œæ•´ç»“æ„æ–‡ä»¶å¯èƒ½è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨æ‘˜è¦æ–‡ä»¶è¿›è¡Œå¿«é€ŸæŸ¥çœ‹
5. **æ›´æ–°é¢‘ç‡**: å»ºè®®åœ¨æ•°æ®åº“ç»“æ„å˜æ›´åé‡æ–°å¯¼å‡º

## ğŸš€ æ‰©å±•åŠŸèƒ½

### å¯ä»¥æ‰©å±•çš„åŠŸèƒ½
1. **æ•°æ®å¯¼å‡º**: åŒæ—¶å¯¼å‡ºè¡¨ç»“æ„å’Œæ•°æ®
2. **æ ¼å¼è½¬æ¢**: æ”¯æŒå¯¼å‡ºä¸ºå…¶ä»–æ ¼å¼ (YAML, XMLç­‰)
3. **å·®å¼‚å¯¹æ¯”**: æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„ç»“æ„å·®å¼‚
4. **å¯è§†åŒ–**: ç”ŸæˆERå›¾æˆ–å…³ç³»å›¾
5. **éªŒè¯æ£€æŸ¥**: æ£€æŸ¥æ•°æ®åº“è®¾è®¡è§„èŒƒ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å‚è€ƒï¼š
- æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬: `scripts/initDatabaseComplete.js`
- æ•°æ®åº“ç»“æ„è¯´æ˜: `æ•°æ®åº“ç»“æ„è¯´æ˜.md`
- é¡¹ç›®æ–‡æ¡£: `README.md`

---

**æœ€åæ›´æ–°**: 2025å¹´9æœˆ14æ—¥  
**ç»´æŠ¤çŠ¶æ€**: æŒç»­æ›´æ–°ä¸­
